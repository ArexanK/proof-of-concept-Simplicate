{"version":3,"file":"decorators.js","sourceRoot":"src/","sources":["decorators.ts"],"names":[],"mappings":"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","sourcesContent":["import { Reflection as Reflect } from '@abraham/reflection';\nimport { Seed } from './seed';\nimport { attributeNameFromProperty, privatePropertyName } from './utils';\n\nconst primitiveTypes = [Boolean, Number, String];\n\nfunction isPrimitive(type: any): boolean {\n  return primitiveTypes.includes(type);\n}\n\nfunction alreadyObserved(target: HTMLElement, name: string, type: any) {\n  return (<any>target).constructor[observeType(type)].includes(name);\n}\n\nfunction observeType(type: any): string {\n  return isPrimitive(type) ? 'observedAttributes' : 'observedProperties';\n}\n\nfunction observeName(prop: string, type: any): string {\n  return isPrimitive(type) ? attributeNameFromProperty(prop) : prop;\n}\n\nfunction observe(target: HTMLElement, name: string, type: any) {\n  if (!alreadyObserved(target, name, type)) {\n    (<any>target).constructor[observeType(type)].push(observeName(name, type));\n  }\n}\n\nfunction getter(name: string, type: any) {\n  const attributeName = attributeNameFromProperty(name);\n  return function(this: Seed) {\n    switch(type) {\n      case String:\n        return this.getAttribute(attributeName);\n      case Number:\n        if (this.hasAttribute(attributeName)) {\n          return Number(this.getAttribute(attributeName));\n        } else {\n          return null;\n        }\n      case Boolean:\n        return this.hasAttribute(attributeName);\n      default:\n        return (<any>this)[privatePropertyName(name)];\n    }\n  }\n}\n\nfunction setter(name: string, type: any) {\n  const attributeName = attributeNameFromProperty(name);\n  return function(this: Seed, value: any) {\n    if (this._ignoreDefaultValue(name) && isPrimitive(type)) {\n      this._ignoredDefaultAttributes[name] = true;\n      return;\n    } else if (!this._ignoredDefaultAttributes[name]) {\n      this._ignoredDefaultAttributes[name] = true;\n    }\n\n    if (value === null || value === undefined || value === false || value === '') {\n      this.removeAttribute(attributeName);\n    } else {\n      switch (type) {\n        case String:\n          this.setAttribute(attributeName, String(value));\n          break;\n        case Number:\n          this.setAttribute(attributeName, String(value));\n          break;\n        case Boolean:\n          this.setAttribute(attributeName, '');\n          break;\n        default:\n         (<any>this)[privatePropertyName(name)] = value;\n      }\n    }\n    this.render();\n  };\n}\n\nexport function property(options?: { type: any }) {\n  return function(target: HTMLElement, name: string) {\n    const type = (options && options.type) || Reflect.getMetadata('design:type', target, name);\n    observe(target, name, type);\n\n    Object.defineProperty(target, name, {\n      configurable: true,\n      enumerable: true,\n      get: getter(name, type),\n      set: setter(name, type),\n    });\n  }\n}\n"]}